<!DOCTYPE html>
<html lang="en" style="height: 100%;">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Application</title>
    </head>
    <body id="body" style="height: 100%; padding: 0; margin: 0; overflow: hidden;">
        <canvas id="canvas" style="height: 100%; width: 100%;"></canvas>

        <script type="text/javascript" src="third-party/stats.js"></script>
        <script type="text/javascript" src="odin.js"></script>
        <script type="text/javascript" src="gpu.js"></script>
        <script type="text/javascript">
            // Initialize Stats
            const stats = new Stats();
            stats.showPanel(0); // 0: fps, 1: ms, 2: mb
            document.body.appendChild(stats.dom);

            const mem = new WebAssembly.Memory({ initial: 2000, maximum: 65536, shared: false });
            const memInterface = new odin.WasmMemoryInterface();
            memInterface.setMemory(mem);
            const wgpuInterface = new odin.WebGPUInterface(memInterface);
            odin.runWasm("app.wasm", null, { webgpu: wgpuInterface.getInterface() }, memInterface, /*intSize=8*/);

            const originalRAF = window.requestAnimationFrame;
            window.requestAnimationFrame = function(callback) {
                return originalRAF.call(window, function(time) {
                    stats.begin();
                    callback(time);
                    stats.end();
                });
            };
        </script>
    </body>
</html>
